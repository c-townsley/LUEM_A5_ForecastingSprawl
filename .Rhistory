labs(title="Development Land Use Change") +
mapTheme
changePoints <-
rasterToPoints(development_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
Dev_fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(lc_change = ifelse(is.na(development_change),0,1),
lc_change = as.factor(development_change))
development_change[development_change != 1] <- 0
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(development_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Cells \nwith Land Cover\nChange") +
labs(title="Development Land Cover Change") +
mapTheme
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(development_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Land Cover\nChange") +
labs(title="Development Land Use Change") +
mapTheme
changePoints <-
rasterToPoints(development_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
Dev_fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(lc_change = ifelse(is.na(development_change),0,1),
lc_change = as.factor(development_change))
Dev_fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
development_change[development_change != 1] <- NA
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(development_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Cells \nwith Land Cover\nChange") +
labs(title="Development Land Cover Change") +
mapTheme
dev_change2[development_change < 1] <- 0
dev_change <- devdelopment_change[development_change < 1] <- 0
dev_change <- development_change[development_change < 1] <- 0
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- 0
names(dev_change) <- "development_change"
dev_change[development_change < 1] <- 0
names(dev_change) <- "development_change"
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(dev_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Land Cover\nChange") +
labs(title="Development Land Use Change") +
mapTheme
dev_change[development_change < 1] <- NA
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(dev_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Land Cover\nChange") +
labs(title="Development Land Use Change") +
mapTheme
#reclassify land cover change using reclass matrix
###LINDSEY
lc_2008r <-
reclassify(lc_2008, reclassMatrix)
lc_2019r <-
reclassify(lc_2019, reclassMatrix)
lc_2008r[lc_2008r < 1] <- 0
names(lc_2008r) <- "dev08"
lc_2019r[lc_2019r < 1] <- 0
names(lc_2019r) <- "dev19"
development_change <- lc_2008r + lc_2019r
hist(development_change)
development_change[development_change != 1] <- NA
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(development_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Cells \nwith Land Cover\nChange") +
labs(title="Development Land Cover Change") +
mapTheme
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(dev_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Land Cover\nChange") +
labs(title="Development Land Use Change") +
mapTheme
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(houstonMSA_fishnet))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_raster(data=rast(dev_change) %>% na.omit,
aes(x,y,fill=as.factor(value))) +
scale_fill_viridis(discrete=TRUE, name ="Land Cover\nChange") +
labs(title="Development Land Use Change") +
mapTheme
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(lc_change = ifelse(is.na(dev_change),0,1),
lc_change = as.factor(dev_change))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(dev_change = ifelse(is.na(dev_change),0,1),
dev_change = as.factor(dev_change))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
View(fishnet)
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=lc_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "As fishnet centroids") +
mapTheme
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=dev_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "As fishnet centroids") +
mapTheme
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "As fishnet centroids") +
mapTheme
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area, n\in fishnet centroids") +
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area, n\in fishnet centroids") +
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area, n/in fishnet centroids") +
mapTheme
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area, \nin fishnet centroids") +
mapTheme
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area, as fishnet centroids") +
mapTheme
### LINDSEY
dev_change <- reclassify(development_change, reclassMatrix)
dev_change[development_change < 1] <- NA
names(dev_change) <- "development_change"
changePoints <-
rasterToPoints(dev_change) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=fishnet,
aes(x=xyC(fishnet)$x, y=xyC(fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area | Fishnet centroids") +
mapTheme
dev_change_fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
dev_change_fishnet <-
aggregate(changePoints, AtlantaMSA_fishnet, sum) %>%
mutate(development_change = ifelse(is.na(development_change),0,1),
development_change = as.factor(development_change))
ggplot() +
geom_sf(data=Atlanta_MSA) +
geom_point(data=dev_change_fishnet,
aes(x=xyC(dev_change_fishnet)$x, y=xyC(dev_change_fishnet)$y, colour=development_change)) +
scale_colour_manual(values = palette2,
labels=c("No Change","New Development"),
name = "") +
labs(title = "Land Cover Development Change", subtitle = "Atlanta metro area | Fishnet centroids") +
mapTheme
dev_change_fishnet <- st_write(dev_change_fishnet, "C:/Users/Lindsey/Desktop/CPLN675_Land_Use_Modeling_Desktop/Final/LUEM_A5_Repo/GeoJSONs/dev_change_fishnet.geojson")
dev_change_fishnet <- st_write(dev_change_fishnet, "C:/Users/Lindsey/Desktop/CPLN675_Land_Use_Modeling_Desktop/Final/LUEM_A5_Repo/Data/geojson/dev_change_fishnet.geojson")
# Look here for variable codes
acs_vars <- load_variables(2009, "acs5")
#Pull 2009 population
Pop09 <-
get_acs(geography = "tract", variables = "B01003_001", year = 2009,
state = 13, geometry = TRUE,
county = Counties) %>%
rename("pop09" = estimate) %>%
st_transform(st_crs(AtlantaMSA_fishnet))
#Pull 2019 population
Pop19 <-
get_acs(geography = "tract", variables = "B01003_001", year = 2019,
state = 13, geometry = TRUE,
county = Counties) %>%
rename("pop19" = estimate) %>%
st_transform(st_crs(AtlantaMSA_fishnet)) %>%
st_buffer(-1) #buffer the the tracts by -1ft. This is done because tidycensus appears to return geometries that are problematic when subjected to the area weighted interpolation function
grid.arrange(
ggplot() +
geom_sf(data = Pop09, aes(fill=factor(ntile(pop09,5))), colour=NA) +
geom_sf(data = Atlanta_MSA,
color = "black", fill = "transparent", linewidth = .75) +
scale_fill_manual(values = palette5,
labels=quintileBreaks(Pop09,"pop09"),
name="Quintile\nBreaks") +
labs(title="2009 Population\nAtlanta 21-County MSA") +
mapTheme,
ggplot() +
geom_sf(data = Pop19, aes(fill=factor(ntile(pop19,5))), colour=NA) +
scale_fill_manual(values = palette5,
labels=quintileBreaks(Pop19,"pop19"),
name="Quintile\nBreaks") +
geom_sf(data = Atlanta_MSA,
color = "black", fill = "transparent", linewidth = .75) +
labs(title="2019 Population\nAtlanta 21-County MSA") +
mapTheme, ncol=2)
AtlantaMSA_fishnet <-
AtlantaMSA_fishnet %>%
rownames_to_column("fishnetID") %>%
mutate(fishnetID = as.numeric(fishnetID)) %>%
dplyr::select(fishnetID)
fishnetPop09 <-
st_interpolate_aw(Pop09["pop09"], AtlantaMSA_fishnet, extensive=TRUE) %>%
as.data.frame(.) %>%
rownames_to_column(var = "fishnetID") %>%
left_join(AtlantaMSA_fishnet %>%
mutate(fishnetID = as.character(fishnetID)),
., by=c("fishnetID"='fishnetID')) %>%
mutate(pop09 = replace_na(pop09,0)) %>%
dplyr::select(pop09)
fishnetPop19 <-
st_interpolate_aw(Pop19["pop19"], AtlantaMSA_fishnet, extensive=TRUE) %>%
as.data.frame(.) %>%
rownames_to_column(var = "fishnetID") %>%
left_join(AtlantaMSA_fishnet %>%
mutate(fishnetID = as.character(fishnetID)),
., by=c("fishnetID"='fishnetID')) %>%
mutate(pop19 = replace_na(pop19,0)) %>%
dplyr::select(pop19)
fishnetPop <-
cbind(fishnetPop09, fishnetPop19) %>%
dplyr::select(pop09,pop19) %>%
mutate(pop_Change = pop19 - pop09)
grid.arrange(
ggplot() +
geom_sf(data=Pop19, aes(fill=factor(ntile(pop19,5))),colour=NA) +
scale_fill_manual(values = palette5,
labels=substr(quintileBreaks(Pop19,"pop19"),1,4),
name="Quintile\nBreaks") +
geom_sf(data = Atlanta_MSA,
color = "black", fill = "transparent", linewidth = .75) +
labs(title="2019 Population\nAtlanta 21-County MSA",
subtitle="Represented as tracts; Boundaries omitted") +
mapTheme,
ggplot() +
geom_sf(data=fishnetPop, aes(fill=factor(ntile(pop19,5))), colour=NA) +
scale_fill_manual(values = palette5,
labels=substr(quintileBreaks(fishnetPop,"pop19"),1,4),
name="Quintile\nBreaks") +
geom_sf(data = Atlanta_MSA,
color = "black", fill = "transparent", linewidth = .75) +
labs(title="2019 Population\nAtlanta 21-County MSA",
subtitle="Represented as fishnet gridcells; Boundaries omitted") +
mapTheme, ncol=2)
#Skip
metro_highways <- st_read("C:/Users/ctown/OneDrive - PennO365/Classes/Classes_Sem4_2023Spring/CPLN 675_Land Modeling/Assignments/A5_SprawlForecasting/LUEM_A5_Repo/Data/shapefile/AtlantaMetro_Major_Roads/Major_Roads.shp")
AtlantaHighways <-
st_read("https://raw.githubusercontent.com/c-townsley/LUEM_A5_Repo/8b689651286bb4ff28554095bd39ce1bd87655e4/Data/geojson/Major_Roads.geojson") %>%
st_transform(st_crs(metro_counties)) %>%
st_intersection(metro_counties) %>%
filter(FEATURE_TY == "State Highway")
ggplot() +
geom_sf(data = Atlanta_MSA,
color = "black", linewidth = .75) +
geom_raster(data=rast(development_change) %>% na.omit,
aes(x,y, fill=as.factor(value==1))) +
geom_sf(data=AtlantaHighways, color="#9C179EFF") +
labs(title = "Highways and New Development") +
mapTheme
emptyRaster <- development_change
emptyRaster[] <- NA
#create a raster layer of highways
highway_raster <-
as(AtlantaHighways,'Spatial') %>%
rasterize(.,emptyRaster)
highway_raster_distance <- distance(highway_raster)
names(highway_raster_distance) <- "distance_highways"
highwayPoints <-
rasterToPoints(highway_raster_distance) %>%
as.data.frame() %>%
st_as_sf(coords = c("x", "y"), crs = st_crs(AtlantaMSA_fishnet))
highwayPoints_fishnet <-
aggregate(highwayPoints, AtlantaMSA_fishnet, mean) %>%
mutate(distance_highways = ifelse(is.na(distance_highways),0,distance_highways))
ggplot() +
geom_sf(data=metro_counties) +
geom_point(data=highwayPoints_fishnet, aes(x=xyC(highwayPoints_fishnet)[,1],
y=xyC(highwayPoints_fishnet)[,2],
colour=factor(ntile(distance_highways,5))),size=1.5) +
scale_colour_manual(values = palette5,
labels=substr(quintileBreaks(highwayPoints_fishnet,"distance_highways"),1,8),
name="Quintile\nBreaks") +
geom_sf(data=AtlantaHighways, colour = "black") +
labs(title = "Distance to Highways",
subtitle = "As fishnet centroids; Highways visualized in red") +
mapTheme
nn_function <- function(measureFrom,measureTo,k) {
#convert the sf layers to matrices
measureFrom_Matrix <-
as.matrix(measureFrom)
measureTo_Matrix <-
as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist
output <-
as.data.frame(nn) %>%
rownames_to_column(var = "thisPoint") %>%
gather(points, point_distance, V1:ncol(.)) %>%
arrange(as.numeric(thisPoint)) %>%
group_by(thisPoint) %>%
summarize(pointDistance = mean(point_distance)) %>%
arrange(as.numeric(thisPoint)) %>%
dplyr::select(-thisPoint) %>%
pull()
return(output)
}
AtlantaMSA_fishnet$lagDevelopment08 <-
nn_function(xyC(AtlantaMSA_fishnet),
xyC(filter(aggregatedRasters08, developed08==1)),
2)
nn_function <- function(measureFrom,measureTo,k) {
#convert the sf layers to matrices
measureFrom_Matrix <-
as.matrix(measureFrom)
measureTo_Matrix <-
as.matrix(measureTo)
nn <-
get.knnx(measureTo, measureFrom, k)$nn.dist
output <-
as.data.frame(nn) %>%
rownames_to_column(var = "thisPoint") %>%
gather(points, point_distance, V1:ncol(.)) %>%
arrange(as.numeric(thisPoint)) %>%
group_by(thisPoint) %>%
summarize(pointDistance = mean(point_distance)) %>%
arrange(as.numeric(thisPoint)) %>%
dplyr::select(-thisPoint) %>%
pull()
return(output)
}
AtlantaMSA_fishnet$lagDevelopment08 <-
nn_function(xyC(AtlantaMSA_fishnet),
xyC(filter(aggregatedRasters08, developed08==1)),
2)
theRasterList08 <- c(developed08, forest08, farm08, wetlands08, otherUndeveloped08, water08)
theRasterList19 <- c(developed19, forest19, farm19, wetlands19, otherUndeveloped19, water19)
aggregatedRasters08 <-
aggregateRaster(theRasterList08, AtlantaMSA_fishnet) %>%
dplyr::select(developed08, forest08, farm08, wetlands08, otherUndeveloped08, water08) %>%
mutate_if(is.numeric, as.factor)
aggregatedRasters19 <-
aggregateRaster(theRasterList19, AtlantaMSA_fishnet) %>%
dplyr::select(developed19, forest19, farm19, wetlands19, otherUndeveloped19, water19) %>%
mutate_if(is.numeric, as.factor)
aggregatedRasters19 %>%
gather(var,value,developed19:water19) %>%
st_cast("POLYGON") %>%    #just to make sure no weird geometries slipped in
mutate(X = xyC(.)$x,
Y = xyC(.)$y) %>%
ggplot() +
geom_sf(data=metro_counties) +
geom_point(aes(X,Y, colour=as.factor(value))) +
facet_wrap(~var) +
scale_colour_manual(values = c(gray, highlight),
labels=c("False","True"),
name = "") +
labs(title = "Land Cover Types, 2019",
subtitle = "As fishnet centroids") +
mapTheme
theRasterList08 <- c(developed08, forest08, farm08, wetlands08, otherUndeveloped08, water08)
theRasterList19 <- c(developed19, forest19, farm19, wetlands19, otherUndeveloped19, water19)
aggregatedRasters08 <-
aggregateRaster(theRasterList08, AtlantaMSA_fishnet) %>%
dplyr::select(developed08, forest08, farm08, wetlands08, otherUndeveloped08, water08) %>%
mutate_if(is.numeric, as.factor)
aggregatedRasters19 <-
aggregateRaster(theRasterList19, AtlantaMSA_fishnet) %>%
dplyr::select(developed19, forest19, farm19, wetlands19, otherUndeveloped19, water19) %>%
mutate_if(is.numeric, as.factor)
aggregatedRasters19 %>%
gather(var,value,developed19:water19) %>%
st_cast("POLYGON") %>%    #just to make sure no weird geometries slipped in
mutate(X = xyC(.)$x,
Y = xyC(.)$y) %>%
ggplot() +
geom_sf(data=metro_counties) +
geom_point(aes(X,Y, colour=as.factor(value))) +
facet_wrap(~var) +
scale_colour_manual(values = c(gray, highlight),
labels=c("False","True"),
name = "") +
labs(title = "Land Cover Types, 2019",
subtitle = "As fishnet centroids") +
mapTheme
View(aggregatedRasters19)
View(aggregatedRasters19)
View(aggregatedRasters08)
